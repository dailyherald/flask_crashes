<!DOCTYPE HTML>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width" />

  <title>
    Pedestrian and cyclist crashes
  </title>

    <link rel="stylesheet" href="static/normalize.css" />

    <!-- BOOTSTRAP Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <script type="text/javascript" src="static/jquery-1.11.3.min.js"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <!-- LEAFLET for mapping -->
      <link rel="stylesheet" href="static/leaflet.css" type="text/css">
      <script src="static/leaflet.js"></script>


 
    <!--Begin Datatables -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs-3.3.7/dt-1.10.13/fc-3.2.2/fh-3.1.2/r-2.1.0/datatables.min.css"/>
    <script type="text/javascript" src="https://cdn.datatables.net/v/bs-3.3.7/dt-1.10.13/fc-3.2.2/fh-3.1.2/r-2.1.0/datatables.min.js"></script>
    <!--end Datatables-->


    <!-- This is the google api needed for development. Comment this out for production 
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script> 
-->

  <!-- This is my API key, for personal use. Need to comment this out for development, but initiate it for production  -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjc-UIpOjUgh456Dj9HMqXQG13cJ7EF7o"></script>

    <script src="static/Google.js"></script>

    <link rel="stylesheet" href="static/newsArt.css" />

<script>
var $ = jQuery;
</script>

<script>

$(document).ready(function() {
    $('#gfx').DataTable( {
      responsive: true,
      "order": [[ 1, "desc" ]],
      "iDisplayLength": 25
      } );
} );

</script>

</head>
<body>

<nav class="navbar navbar-default navbar-static-top" style="margin : 0 !important;">
    <div class="container-fluid">

        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <img alt="Brand" src="static/img/dh.png"></a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li><a href="http://www.dailyherald.com" target="_blank">Daily Herald</a></li>
                <li><a href="http://reportcards.dailyherald.com/gfx/" target="_blank">Daily Herald News Art</a></li>
            </ul>
        </div>
    </div>
</nav>



<div style="background-color:black;padding:20px;">
    <div class="row">
        <div class="col-md-12">
            <br>
            <img src="static/img/crossings.jpg" class="img-responsive center-block"><br>
           
            <h1 class="headstyle">Perilous Passage</h1>
            <br>
            <h3 style="color:white; font-size:26px; text-align:center;">Pedestrian and cyclist crashes in the suburbs, 2012-2015</h3><br>
            <div class = "row">
                <div class="col-sm-6 col-xs-12 col-centered">
                    <table style="color:white;width:100%;border-collapse: separate;
    border-spacing: 10px 0px;" >
                        <thead>
                            <th class="thCENT">TOTAL<br>CRASHES</th>
                            <th class="thCENT">CRASHES<br>WITH INJURIES</th>
                            <th class="thCENT">CRASHES</br>WITH FATALITIES</th>
                        </thead>
                        <tbody>
                            <tr><td class="tdCENT"><strong>9,868</strong></td>
                                <td class="tdCENT"><strong>9,290</td>
                                <td class="tdCENT"><strong>250</td>
                            </tr>
                        </tbody>
                    </table>
                    <br>
                    <p class="source" style="color:white;text-align:center;">Note: Suburban totals include unincorporated areas. Data from Chicago is included in the map and list below.</p>
                </div>
            </div>
                    <br>


            <div class = "row">
                <div class="col-sm-6 col-xs-12"><span class="align-middle">
                        
                        <p style="color:white;font-size:16px;">
                        Among the municipalities the Daily Herald examined, the number of total crashes between vehicles and pedestrians or cyclists closely tracks population. The more people in a town, the higher the number of crashes.<br>
                        But for total fatalities in the years examined (2012-2015), half of municipalities with five or more fatalities were not among the top 10 in population. Nor were Des Plaines, Skokie, Chicago Heights and Oak Lawn among the top 10 municipalities for any of the years examined when calculated by rate of crashes per 1,000. Harvey was among the top 10 total crash rates once, in 2012.<br>
                        To learn more about these and the other towns examined, select the town in the interactive map or find it in the searchable, sortable list below.
                        </p>
                        <hr style="color:white;">
                        <h4 style="color:white;">Map key</h4>
                        <p>
                            <style type="text/css">
                                div.bar {
                                    display: inline-block;
                                    width: 12px;
                                    height: 12px;
                                    border: 1px solid;
                                    border-color:white;
                                    opacity: 0.8;
                                    }
                                .cont2 {
                                    background-color: white;
                                    }
                                .cont3 {
                                    background-color: #dfc27d;
                                    }
                                .cont4 {
                                    background-color: #80cdc1;
                                    }
                                .cont5 {
                                    background-color: #018571;
                                    }
                            </style>
                                <div class="bar cont5"></div> <span style="color:white;">Towns with five or more crashes with fatalities, crashes with injuries.</span></br>
                                <div class="bar cont4"></div> <span style="color:white;">Towns with fewer than five crashes with fatalities, crashes with injuries.</span><br>
                                <div class="bar cont3"></div> <span style="color:white;">Towns with crashes with injuries only.</span><br>
                                <div class="bar cont2"></div> <span style="color:white;">No data available.</span>
                            </p>
                        <p class="small" style="color:white;">Note: South Barrington reported one crash with a fatality, but no crashes with injuries.</p> 
                </span>
                </div>
                <div class="col-sm-6 col-xs-12">
                    <p class="small" style="color:white;">The map below is interactive. <strong><span style="color:red">Click or touch</span></strong> a town to see more.</p> 
                    <div id="pageMap" style="width:100%; height:450px;"></div>
                </div>
            </div>
        </div>
    </div>
</div>
<br>
<div class="container" >
    <div class="row">
        <div class="col-md-12">
            <h1>Vehicle crashes with pedestrians and cyclists<br><small>Ordered by total crashes 2012-2015.</small></h1>
            <p class="topmargin"><strong>The list below is interactive: </strong><span style="color:red">Sort</span> the list by clicking on the column headings, or <span style="color:red">look for your municipality</span> using the search box. You can also <span style="color:red">choose to view</span> more at a time with the "Show entries" box.</strong></p>
            <p class="topmargin"><strong><span style="color:red">Click the municipality name</span></strong> to view more complete statistics for each year available.</p>
            <p>
                <table id="gfx" class="table table-hover table-striped table-condensed display" width="100%" ><thead>
                        <th class="thLEFT text-nowrap">Town</th>
                        <th>Total crashes</th>
                        <th>Crashes<br>with injuries</th>
                        <th>Crashes<br>with fatalities</th>
                    </thead>
                    <tbody> <!-- be sure to specify index.html or it will not work with freeze -->
                        {% for obj in object_list %}
                        <tr><td class="tdLEFT text-nowrap"><a href="{{obj.id}}/index.html">{{ obj.Town }}</a></td>
                            <td>{{ obj.total_crashes }}</td>
                            <td>{{ obj.total_inj }}</td>
                            <td>{{ obj.total_fatal }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </p>
                
        </div>
    </div>
</div>

<div id="creditBox">
  <div class="row">
    <div class="col-md-10 center-block center-blockfloat">
      <p><small>Daily Herald web app by Tim Broderick <a href="mailto:tbroderick@dailyherald.com">tbroderick@dailyherald.com</a>. Source: Illinois Department of Transportation, Bureau of Safety Programs and Engineering. <br>
        Data of motor vehicle crashes involving pedestrians and cyclists for the years 2012-2015. Not every town in the six-county area around Chicago was included, and not every town included had stats for each year.<br>
        All files and data are available at our <a href="https://github.com/dailyherald/flask_crashes" target="_blank">github site</a>. A look of how we examined the data can be <a href="https://dailyherald.github.io/flask_crashes/index.html" target="_blank">found here</a>. App based on <a href="https://first-news-app.readthedocs.io/en/latest/" target="_blank">First News App</a> by <a href="http://palewi.re/who-is-ben-welsh/" target="_blank">Ben Welsh</a>. 
      </small></p>
    </div>
  </div>
</div>
<div id="underfoot"></div>



<script type="text/javascript">

var map = L.map('pageMap');

/* For productiom map */

var GGLstyles = [
  {"featureType":"all","stylers":[{"saturation":-85},{"gamma":1}]}
  ];


var ggl = new L.Google('ROADMAP', {
  mapOptions: {
    styles: GGLstyles
  }
});



/*var osmLayer = new L.TileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 18,
    attribution: 'Data, imagery and map information provided by <a href="http://www.openstreetmap.org/" target="_blank">OpenStreetMap</a>.'
}); */


$.getJSON("static/crashes.geojson", function(data) {

  var geojson = L.geoJson(data, {
    
    style: function (feature) {
        if (feature.properties.mapping_color == "fatal5") {
          return {
            fillColor: "#018571",
            weight: 1,
            opacity: 1,
            dashArray: '',
            fillOpacity: 0.5
          };
        } else if (feature.properties.mapping_color == "fatal") {
          return {
            fillColor: "#80cdc1",
            weight: 1,
            opacity: 1,
            dashArray: '',
            fillOpacity: 0.5
          };
        } else if (feature.properties.mapping_color == "crash") {
          return {
            fillColor: "#dfc27d",
            weight: 1,
            opacity: 1,
            dashArray: '',
            fillOpacity: 0.5
          };
        } else {
          return {
            fillColor: "white",
            weight: 1,
            opacity: 1,
            dashArray: '',
            fillOpacity: 0.5
          };
        }
    },

    onEachFeature: function (feature, layer) {
      layer.bindPopup(
        '<strong><a href="' + feature.properties.mapping_id + '/index.html">' + feature.properties.mapping_Town + '</strong></a><table class="mapTable table table-striped table-condensed"><tr><td class="tdLEFT">Total crashes</td><td>' + feature.properties.mapping_total_crashes + '</td><tr><td class="tdLEFT">Total with<br>injuries:</td><td>' + feature.properties.mapping_total_inj + '</td><tr><td class="tdLEFT">Total with<br>fatalities</td><td>' + feature.properties.mapping_total_fatal + '</td></tr></table>'
  
        );
    }


  });



map.addLayer(ggl);

map.setView(new L.LatLng(41.9, -88),9);
/* map.addLayer(osmLayer); */
geojson.addTo(map);

});

</script>

</body>
</html>